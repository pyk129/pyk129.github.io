---
title: 스니핑 공격
date: 2022-08-03 18:32:00 -0500
categories: 1Page보안이야기
---

# 1.스니핑(Sniffing)이란?
스니핑을 할 수 있는 도구인 스니퍼를 이용해서 네트워크상의 다른 사용자들의 중요 데이터를 도청을 통해 취득하는 해킹 기법

# 2. 스니핑 공격방법과 탐지방법
## 가. 스니핑 공격방법



|공격방법  |설명|
|:--:|:-------|
| Switch Jamming | 스위치의 주소 테이블이 가득 차게되었을때 패킷을 모든 포트로 브로드케스팅 하는 성질을 이용한 공격.<br>공격자는 MAC Address Table을 모두 채우기 위해 변조한 MAC 정보를 담고 있는 ARP Reply 패킷을 계속해서 스위치에게 전송 |
| ARP Spoofing | 공격자가 호스트가 통신하는 상대방의 MAC 주소를 자신의 MAC 주소로 위조한 ARP Reply패킷을 지속적 보내면 Alice의 ARP Cache Table에 Alice가 통신하고자 하는 호스트의 MAC 주소가 공격자의 맥 주소로 변경되어 스니핑 수행 |
| ARP Redirect| 공격자가 MAC주소를 위조한 ARP Reply 패킷을 브로드캐스트 하여, 네트워크에 연결된 모든 호스트의 맥주소 테이블내의 수신자 MAC주소를 공격자의 MAC주소로 변조 하여 스니핑 |
| ICMP Redirect | L3(네트워크 레이어)의 라우팅 테이블의 게이트웨이 주소를 변조, 공격자는 라우터에서 호스트 또는 라우터간의 라우팅 경로를 재설정하는 ICMP 리다이렉트 메시지를 공격 대상자에 전송, 대상자 호스트의 라우팅테이블을 변조해서 스니핑하여 공격수행|
| Monitorport설정 | 포트 모니터링 기능을 가지는 스위치의 접근 권한을 얻어내서 공격자 시스템에 연결된 포트로 보내서 스니핑하는 공격 <br>- 포트 모니터링 : 특정 포트로 주고받는 패킷을 다른 모니터 포트로 전송해 주는 옵션|


- 맥 주소 테이블(MAC Address Table) : L2스위치에 연결된 사용자들의 맥 주소를 저장한 테이블, 브릿지 테이블이라고도 함<br>
- 디폴트로 설정된 스위치의 경우 해당 스위치의 사용자 아이디, 패스워드를 인터넷 검색사이트를 통해 검색 가능<br>

## 나. 스니핑 탐지방법


|탐지방법  |설명|
|:--:|:-------|
|핑(Ping) 탐지| 의심 가는 호스트의 네트워크에 존재하지 않는 맥 주소를 위장 송신. 만약 대상 컴퓨터가 이에 응답하는 메시지(ICMP Echo Reply)를 보내면 해당 호스트가 스니핑 탐지|
|ARP 감지|위조된 ARP 요청을 보냈을 때 에이알피 응답이 오면 프로미스큐어스 모드(promiscuous mode)로 설정된 것이므로 스니핑 탐지 수행 <br>- 프로미스큐어스 모드 : 자신의 주소 값을 무시하고 모든 패킷을 받아들이는 상태 모드 |
|DNS 탐지|IP를 통해서 도메인을 요청하는 DNS Inverse Lookpup 요청을 감시하여 스니핑 탐지|
|공격자유도|가짜 아이디와 패스워드를 네트워크에 뿌리고 공격자가 이 아이디와 패스워드를 이용하여 접속을 시도할 때 스니핑 탐지|
|ARP Watch탐지|초기 MAC주소와 IP 주소의 값 저장후 ARP 트래픽을 상시 모니터링 하여 MAC 주소와 IP 주소 값을 변경하는 이상패킷이 발견되면 관리자에게 알려줌으로서 스니핑 탐지 수행|


- SSL, SSH, VPN을 통해 스니핑에 대한 방어 수행

# 3. 스니핑 방어방안


|방어방법  |설명|
|:---:|---|
|SSL 적용 |SSL을 통해 사용자의 아이디, 패스워드 및 전자 상거래 결재 정보 등 웹 서핑의 내용 암호화 통해 스니핑 대응 |
|PGP, S/MIME |전자우편 내용 암호화하는 PGP, S/MIME를 통해 전자우편 내용을 보호함으로써 스니핑 대응|
|SSH |공개 키 방식의 암호 방식을 사용하여 원격지 시스템에 접근하여 암호화된 메시지를 전송할 수 있는 SSH를 사용하여 스니핑 대응. SSH는 암호화 통신을 제공하여 텔넷, FTP, RCP, 알로긴 등을 대치 가능 |
|VPN|스니핑이 우려되는 네트워크 상에 전용선 또는 VPN으로 으로 직접 연결함으로 스니핑 대응|





# 4. 참고
## ARP(Address Resolution Protocol) 
1. 네트워크 상에서 IP 주소를 물리적 네트워크 주소로 대응(bind)시키기 위해 사용되는 프로토콜
2. L2 스위치는 이더넷 프레임(MAC 기반), L3 스위치는 패킷(IP 주소 기반) 를 기준으로 동작

## 맥 주소 테이블 동작 방식 (맥 주소 존재)
1. A->B 데이터 보내기 위해 스위치에 데이터(프레임) 전송
2. 스위치는 B사용자에게 데이터를 전송
3. 등록 : 데티어가 스위치를 거치면 맥 주소 테이블에 자동 등록(관리자가 임의로 등록 가능)

## 맥 주소 테이블 동작 방식 (맥 주소 미존재)
1. A->B 데이터 보내기 위해 스위치에 데이터(프레임) 전송
2. (맥 주소 미존재) ARP를 이용해 B사용자의 알아낸 후 전송 (ARP는 브로드캐스트)
3. 등록 : 데티어가 스위치를 거치면 맥 주소 테이블에 자동 등록(관리자가 임의로 등록 가능)
